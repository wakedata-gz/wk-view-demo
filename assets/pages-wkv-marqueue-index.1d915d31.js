import{_ as e}from"./wk-section.3aca4118.js";import{_ as t,r as n,j as s,q as a,s as r,v as o,x as i,h as l,u as c,o as u,c as d,w as m,e as f,m as p,f as h,t as v,a as k,F as _,b as y,k as q,n as b,i as w}from"./index-7b1e858d.js";import{r as z}from"./uni-app.es.9af6c891.js";import{_ as g}from"./wkv-icons.961e9f4a.js";const x=t({__name:"wkv-marqueue",props:{horizontal:{type:Boolean,default:!0},contents:{type:[String,Array],default:""},speed:{type:Number,default:2},duration:{type:Number,default:3e3},showButton:{type:Boolean,default:!0},buttonText:{type:String,default:"更多"}},emits:["moreClick"],setup(e,{emit:t}){const x=e,I=n(),$=n(),B=s((()=>x.horizontal||Array.isArray(x.contents)?x.contents:[x.contents])),j=a({visible:!0,distance:0,starterId:0,current:-1}),A=s((()=>x.horizontal?Boolean(x.contents):Boolean(x.contents.length)));r((()=>[x.contents,x.horizontal]),(()=>{C()}));const C=()=>{j.starterId=Math.random(),x.horizontal?F(j.starterId):T(j.starterId)},F=e=>{j.current=0;const{clientWidth:t}=I.value.$el,{scrollWidth:n}=$.value.$el;if(n<=t)return;j.distance=t;const s=()=>{j.visible&&j.starterId===e&&(j.distance=j.distance>-n?j.distance-x.speed:t,requestAnimationFrame(s))};s()},T=e=>{if(j.current=-1,x.contents.length<=1)return void(j.current=0);const{clientHeight:t}=I.value.$el,{scrollHeight:n}=$.value.$el;j.distance=t;let s=0;const a=()=>{j.visible&&j.starterId===e&&(j.distance=j.distance>-n?j.distance-x.speed:t,s+=x.speed,s<t?requestAnimationFrame(a):(s=0,j.current=j.current<x.contents.length-1?j.current+1:0,j.distance=-t*j.current,setTimeout(a,x.duration)))};a()},H=()=>{const e=x.horizontal?x.contents:x.contents[j.current];t("moreClick",e,j.current)},L=()=>{j.visible=!1};return o((()=>{C()})),i((()=>{L()})),(t,n)=>{const s=w,a=z(l("wkv-icons"),g);return c(j).visible?(u(),d(s,{key:0,class:b("wkv-marqueue wkv-marqueue--"+(x.horizontal?"horizontal":"vertical"))},{default:m((()=>[f(s,{ref_key:"marqueeListBox",ref:I,class:"marquee-content-list-box"},{default:m((()=>[f(s,{ref_key:"marqueeList",ref:$,class:"marquee-content-list",style:p(x.horizontal?`margin-left: ${c(j).distance}px`:`margin-top: ${c(j).distance}px`)},{default:m((()=>[x.horizontal?(u(),d(s,{key:0,class:"marquee-content-item"},{default:m((()=>[h(v(x.contents),1)])),_:1})):(u(!0),k(_,{key:1},y(c(B),((e,t)=>(u(),d(s,{class:"marquee-content-item",key:`${e}-${t}`},{default:m((()=>[h(v(e),1)])),_:2},1024)))),128))])),_:1},8,["style"])])),_:1},512),c(A)&&e.showButton?(u(),d(s,{key:0,class:"wkv-button",onClick:H},{default:m((()=>[h(v(e.buttonText),1)])),_:1})):q("",!0),f(a,{class:"btn-close",name:"close",size:14,onClick:L})])),_:1},8,["class"])):q("",!0)}}},[["__scopeId","data-v-c4f86a51"]]);const I=t({},[["render",function(t,n){const s=z(l("wk-section"),e),a=z(l("wkv-marqueue"),x),r=w;return u(),d(r,{class:"wkv-marqueue-example"},{default:m((()=>[f(s,null,{default:m((()=>[h("horizontal")])),_:1}),f(a,{contents:"走马灯,我是一个走马灯啊!!!!!!是一个一直在动的走马灯!!!~~~~"}),f(s,null,{default:m((()=>[h("vertical")])),_:1}),f(a,{horizontal:!1,contents:["公告1：测试公告1","公告2：测试公告2"]})])),_:1})}],["__scopeId","data-v-27a17e80"]]);export{I as default};
